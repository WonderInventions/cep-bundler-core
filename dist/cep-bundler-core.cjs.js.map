{"version":3,"file":"cep-bundler-core.cjs.js","sources":["../src/templates/manifest.js","../src/templates/html.js","../src/templates/.debug.js","../src/index.js"],"sourcesContent":["var sizeTemplate = (name, width, height) =>\n  width !== undefined && height !== undefined ? `\n            <${name}>\n              <Width>${width}</Width>\n              <Height>${height}</Height>\n            </${name}>` : '';\n\nexport default ({\n  isDev,\n  bundleName,\n  bundleId,\n  hosts,\n  bundleVersion,\n  cepVersion,\n  extensions\n}) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<ExtensionManifest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ExtensionBundleId=\"${bundleId}\" ExtensionBundleName=\"${bundleName}\" ExtensionBundleVersion=\"${bundleVersion}\" Version=\"${cepVersion}\">\n  <ExtensionList>\n    ${extensions.map(extension => `<Extension Id=\"${extension.id}\" Version=\"${bundleVersion}\" />`).join('\\n    ')}\n  </ExtensionList>\n  <ExecutionEnvironment>\n    <HostList>\n      ${hosts\n        .map(host => `<Host Name=\"${host.name}\" Version=\"${host.version}\" />`)\n        .join('\\n      ')}\n    </HostList>\n    <LocaleList>\n      <Locale Code=\"All\"/>\n    </LocaleList>\n    <RequiredRuntimeList>\n      <RequiredRuntime Name=\"CSXS\" Version=\"${cepVersion}\" />\n    </RequiredRuntimeList>\n  </ExecutionEnvironment>\n  <DispatchInfoList>\n    ${extensions.map(extension => {\n      var commandLineParams = extension.cefParams.map(\n        cefParam => `<Parameter>${cefParam}</Parameter>`\n      )\n      var icons = [\n        { icon: extension.iconNormal, type: 'Normal' },\n        { icon: extension.iconRollover, type: 'RollOver' },\n        { icon: extension.iconDarkNormal, type: 'DarkNormal' },\n        { icon: extension.iconDarkRollover, type: 'DarkRollOver' },\n      ]\n        .filter(({ icon }) => !!icon)\n        .map(({ icon, type }) => `<Icon Type=\"${type}\">${icon}</Icon>`)\n        .join('\\n            ')\n      var size = sizeTemplate('Size', extension.panelWidth, extension.panelHeight);\n      var minSize = sizeTemplate('MinSize', extension.panelMinWidth, extension.panelMinHeight);\n      var maxSize = sizeTemplate('MaxSize', extension.panelMaxWidth, extension.panelMaxHeight);\n      var startOn = (!extension.lifecycle.startOnEvents || extension.lifecycle.startOnEvents.length === 0) ? '' : `\n          <StartOn>\n            ${extension.lifecycle.startOnEvents.map(e => `<Event>${e}</Event>`).join('\\n            ')}\n          </StartOn>`;\n      return `<Extension Id=\"${extension.id}\">\n      <DispatchInfo>\n        <Resources>\n          <MainPath>${isDev ? `./dev.${extension.id}.html` : extension.htmlFilename}</MainPath>\n          <CEFCommandLine>\n            ${commandLineParams.join('\\n            ')}\n          </CEFCommandLine>\n        </Resources>\n        <Lifecycle>\n          <AutoVisible>${extension.lifecycle.autoVisible}</AutoVisible>${startOn}\n        </Lifecycle>\n        <UI>\n          <Type>${extension.type || 'Panel'}</Type>\n          ${extension.menu === false ? '' : `<Menu>${extension.name}</Menu>`}\n          <Geometry>${size}${minSize}${maxSize}\n          </Geometry>${icons ? `\n          <Icons>${icons}</Icons>` : ''}\n        </UI>\n      </DispatchInfo>\n    </Extension>`}).join('\\n    ')}\n  </DispatchInfoList>\n</ExtensionManifest>`\n}","export default ({ title = 'CEP Panel', href }) => {\n  return `<!DOCTYPE html>\n<html>\n  <head>\n    <title>${title}</title>\n  </head>\n  <body>\n    <script>\n      window.location.href = \"${href}\";\n    </script>\n  </body>\n</html>`\n}","export default ({ extensions }) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ExtensionList>\n  ${extensions.map(extension => `<Extension Id=\"${extension.id}\">\n    <HostList>\n      ${Object.keys(extension.debugPorts)\n        .map(\n          (host) =>\n            `<Host Name=\"${host.trim()}\" Port=\"${extension.debugPorts[host]}\" />`\n        )\n        .join('\\n      ')}\n    </HostList>\n  </Extension>`).join('\\n  ')}\n</ExtensionList>`\n}\n","import os from 'os'\nimport path from 'path'\nimport { execSync } from 'child_process'\nimport fs from 'fs-extra'\n\nimport manifestTemplate from './templates/manifest'\nimport panelTemplate from './templates/html'\nimport debugTemplate from './templates/.debug'\n\nfunction templateDebug(formatter) {\n  return [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n    .map(formatter)\n    .join(os.EOL)\n}\n\nexport function enablePlayerDebugMode() {\n  // enable unsigned extensions\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 1`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG ADD HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode /t REG_SZ /d 1`\n      )\n    )\n  }\n}\n\nexport function disablePlayerDebugMode() {\n  // disable unsigned extensions\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 0`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG DELETE HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode`\n      )\n    )\n  }\n}\n\nfunction camelToSnake(str) {\n  return str.replace(/([A-Z])/g, (part) => `_${part.toLowerCase()}`)\n}\n\nfunction isTruthy(str) {\n  return typeof str === 'string' && (str === '1' || str.toLowerCase() === 'true')\n}\n\nfunction getEnvConfig() {\n  const debugPortEnvs = Object.keys(process.env)\n    .filter((key) => key.indexOf('CEP_DEBUG_PORT_') === 0)\n  return {\n    bundleName: process.env.CEP_NAME,\n    bundleId: process.env.CEP_ID,\n    bundleVersion: process.env.CEP_VERSION,\n    cepVersion: process.env.CEP_CEP_VERSION,\n    hosts: process.env.CEP_HOSTS,\n    iconNormal: process.env.CEP_ICON_NORMAL,\n    iconRollover: process.env.CEP_ICON_ROLLOVER,\n    iconDarkNormal: process.env.CEP_ICON_DARK_NORMAL,\n    iconDarkRollover: process.env.CEP_ICON_DARK_ROLLOVER,\n    panelWidth: process.env.CEP_PANEL_WIDTH,\n    panelHeight: process.env.CEP_PANEL_HEIGHT,\n    panelMinWidth: process.env.CEP_PANEL_MIN_WIDTH,\n    panelMinHeight: process.env.CEP_PANEL_MIN_HEIGHT,\n    panelMaxWidth: process.env.CEP_PANEL_MAX_WIDTH,\n    panelMaxHeight: process.env.CEP_PANEL_MAX_HEIGHT,\n    devHost: process.env.CEP_DEV_HOST,\n    devPort: !process.env.CEP_DEV_PORT ? undefined : Number(process.env.CEP_DEV_PORT),\n    debugPorts: debugPortEnvs.length > 0\n      ? debugPortEnvs.reduce((obj, key) => {\n        obj[key.replace('CEP_DEBUG_PORT_', '')] = parseInt(process.env[key], 10)\n        return obj\n      }, {})\n      : undefined,\n    debugInProduction: isTruthy(process.env.CEP_DEBUG_IN_PRODUCTION) || undefined,\n    cefParams: !process.env.CEP_CEF_PARAMS ? undefined : process.env.CEP_CEF_PARAMS.split(',')\n  }\n}\n\nfunction getPkgConfig(pkg, env) {\n  const pkgConfig = pkg.hasOwnProperty('cep')\n    ? (\n      pkg.cep.hasOwnProperty(env)\n        ? pkg.cep[env]\n        : pkg.cep\n    )\n    : {}\n  return {\n    bundleName: pkgConfig.name,\n    bundleId: pkgConfig.id,\n    bundleVersion: pkgConfig.version,\n    cepVersion: pkgConfig.cepVersion,\n    hosts: pkgConfig.hosts,\n    iconNormal: pkgConfig.iconNormal,\n    iconRollover: pkgConfig.iconRollover,\n    iconDarkNormal: pkgConfig.iconDarkNormal,\n    iconDarkRollover: pkgConfig.iconDarkRollover,\n    panelWidth: pkgConfig.panelWidth,\n    panelHeight: pkgConfig.panelHeight,\n    panelMinWidth: pkgConfig.panelMinWidth,\n    panelMinHeight: pkgConfig.panelMinHeight,\n    panelMaxWidth: pkgConfig.panelMaxWidth,\n    panelMaxHeight: pkgConfig.panelMaxHeight,\n    debugPorts: pkgConfig.debugPorts,\n    debugInProduction: pkgConfig.debugInProduction,\n    lifecycle: pkgConfig.lifecycle,\n    cefParams: pkgConfig.cefParams,\n    htmlFilename: pkgConfig.htmlFilename,\n    extensions: pkgConfig.extensions,\n    devHost: pkgConfig.devHost,\n    devPort: pkgConfig.devPort,\n  }\n}\n\nfunction getConfigDefaults() {\n  return {\n    bundleName: 'CEP Extension',\n    bundleId: 'com.mycompany.myextension',\n    hosts: '*',\n    debugInProduction: false,\n    cepVersion: '8.0',\n    panelWidth: 500,\n    panelHeight: 500,\n    htmlFilename: './index.html',\n    devHost: 'localhost',\n    devPort: 8080,\n    lifecycle: {\n      autoVisible: true,\n      startOnEvents: []\n    },\n    cefParams: [\n      '--allow-file-access-from-files',\n      '--allow-file-access',\n      '--enable-nodejs',\n      '--mixed-context'\n    ],\n    debugPorts: {\n      PHXS: 3001,\n      IDSN: 3002,\n      AICY: 3003,\n      ILST: 3004,\n      PPRO: 3005,\n      PRLD: 3006,\n      AEFT: 3007,\n      FLPR: 3008,\n      AUDT: 3009,\n      DRWV: 3010,\n      MUST: 3011,\n      KBRG: 3012,\n    }\n  }\n}\n\nfunction assignDefined(target, ...sources) {\n  for (const source of sources) {\n      for (const key of Object.keys(source)) {\n          const val = source[key];\n          if (val !== undefined) {\n              target[key] = val;\n          }\n      }\n  }\n  return target;\n}\n\nexport function getConfig(pkg, env) {\n  const config = assignDefined(\n    {}, \n    getConfigDefaults(),\n    getPkgConfig(pkg, env),\n    getEnvConfig()\n  )\n  // console.log('DEFAULTS', config)\n  config.hosts = parseHosts(config.hosts)\n  let extensions = []\n  if (Array.isArray(config.extensions)) {\n    extensions = config.extensions.map(extension => {\n      return assignDefined({}, config, extension)\n    })\n  } else {\n    extensions.push({\n      id: config.bundleId,\n      name: config.bundleName,\n      ...config\n    })\n  }\n  config.extensions = extensions\n  // console.log('FINAL', config)\n  return config\n}\n\nexport function objectToProcessEnv(obj) {\n  // assign object to process.env so they can be used in the code\n  Object.keys(obj).forEach(key => {\n    const envKey = camelToSnake(key).toUpperCase()\n    const value = typeof obj[key] === 'string'\n      ? obj[key]\n      : JSON.stringify(obj[key])\n    process.env[envKey] = value\n  })\n}\n\nexport function writeExtensionTemplates(opts) {\n  const manifestContents = manifestTemplate(opts)\n  const {\n    out,\n    debugInProduction,\n    isDev,\n    extensions\n  } = opts\n  const manifestDir = path.join(out, 'CSXS')\n  const manifestFile = path.join(manifestDir, 'manifest.xml')\n  return Promise.resolve()\n    .then(() => fs.ensureDir(manifestDir))\n    .then(() => fs.writeFile(manifestFile, manifestContents))\n    .then(() => {\n      let chain = Promise.resolve()\n      if (debugInProduction || isDev) {\n        const debugContents = debugTemplate(opts)\n        chain = chain.then(() => fs.writeFile(path.join(out, '.debug'), debugContents))\n      }\n      if (isDev) {\n        extensions.forEach(extension => {\n          const href = `http://${extension.devHost}:${extension.devPort}`\n          const panelContents = panelTemplate({\n            title: extension.name,\n            href\n          })\n          chain = chain.then(() => fs.writeFile(path.join(out, `dev.${extension.id}.html`), panelContents))\n        })\n      }\n      return chain\n    })\n}\n\nexport function parseHosts(hostsString) {\n  if (hostsString == '*')\n    hostsString = `PHXS, IDSN, AICY, ILST, PPRO, PRLD, AEFT, FLPR, AUDT, DRWV, MUST, KBRG`\n  const hosts = hostsString\n    .split(/(?![^)(]*\\([^)(]*?\\)\\)),(?![^\\[]*\\])/)\n    .map(host => host.trim())\n    .map(host => {\n      let [name, version] = host.split('@')\n      if (version == '*' || !version) {\n        version = '[0.0,99.9]'\n      } else if (version) {\n        version = version\n      }\n      return {\n        name,\n        version,\n      }\n    })\n  return hosts\n}\n\nexport function getExtenstionPath() {\n  if (process.platform == 'darwin') {\n    return path.join(\n      os.homedir(),\n      '/Library/Application Support/Adobe/CEP/extensions'\n    )\n  } else if (process.platform == 'win32') {\n    return path.join(process.env.APPDATA, 'Adobe/CEP/extensions')\n  }\n}\n\nfunction getSymlinkExtensionPath({ bundleId }) {\n  const extensionPath = getExtenstionPath()\n  return path.join(extensionPath, bundleId)\n}\n\nexport function symlinkExtension({ bundleId, out }) {\n  const target = getSymlinkExtensionPath({ bundleId })\n  return Promise.resolve()\n    .then(() => fs.ensureDir(getExtenstionPath()))\n    .then(() => fs.remove(target))\n    .then(() => {\n      if (process.platform === 'win32') {\n        return fs.symlink(path.join(out, '/'), target, 'junction')\n      } else {\n        return fs.symlink(path.join(out, '/'), target)\n      }\n    })\n}\n\nexport function copyDependencies({ root, out, pkg }) {\n  const deps = pkg.dependencies || {}\n  return Object.keys(deps).reduce((chain, dep) => {\n    if (dep.indexOf('/') !== -1) {\n      dep = dep.split('/')[0]\n    }\n    const src = path.join(root, 'node_modules', dep)\n    const dest = path.join(out, 'node_modules', dep)\n    let exists = false\n    try {\n      exists = fs.statSync(dest).isFile();\n    } catch (err) {}\n    if (!exists) {\n      chain = chain\n        .then(() => fs.copy(src, dest))\n        .catch(() => {\n          console.error(\n            `Could not copy ${src} to ${dest}. Ensure the path is correct.`\n          )\n        })\n        .then(() => {\n          try {\n            const packageJson = fs.readJsonSync(path.join(root, 'node_modules', dep, 'package.json'))\n            return copyDependencies({\n              root,\n              out,\n              pkg: packageJson\n            })\n          } catch (err) {\n            return\n          }\n        })\n      return chain\n    }\n    return chain\n  }, Promise.resolve())\n}\n\nexport function copyIcons({\n  root,\n  out,\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover\n}) {\n  const iconPaths = [\n    iconNormal,\n    iconRollover,\n    iconDarkNormal,\n    iconDarkRollover,\n  ]\n    .filter(icon => icon !== undefined)\n    .map(icon => ({\n        source: path.resolve(root, icon),\n        output: path.join(out, path.relative(root, icon)),\n    }))\n  return Promise.all(\n    iconPaths.map(icon => {\n      return fs.copy(icon.source, icon.output)\n        .catch(() => {\n          console.error(\n            `Could not copy ${icon.source}. Ensure the path is correct.`\n          )\n        })\n    })\n  )\n}\n\nexport function compile(opts) {\n  opts.env = opts.env ? opts.env : process.env.NODE_ENV\n  opts.root = opts.root ? opts.root : process.cwd()\n  opts.htmlFilename = opts.htmlFilename ? opts.htmlFilename : './index.html'\n  opts.pkg = opts.pkg ? opts.pkg : require(path.join(opts.root, '/package.json'))\n  if (opts.devPort || opts.devHost) {\n    throw new Error('devPort and devHost can only be passed in through the package.json config or using ENV variables now, please update your cep.config.js and package.json or env variables')\n  }\n  opts.isDev = opts.hasOwnProperty('isDev') ? opts.isDev : false\n  const config = getConfig(opts.pkg, opts.env)\n  const allOpts = {\n    ...opts,\n    ...config,\n  }\n  let chain = Promise.resolve()\n  if (opts.isDev) {\n    enablePlayerDebugMode()\n    if (!config.noSymlink) {\n      chain = chain.then(() => symlinkExtension(allOpts))\n    }\n  }\n  chain = chain.then(() => copyDependencies(allOpts))\n    .then(() => writeExtensionTemplates(allOpts))\n    .then(() => copyIcons(allOpts))\n  return chain\n}"],"names":["sizeTemplate","name","width","height","undefined","isDev","bundleName","bundleId","hosts","bundleVersion","cepVersion","extensions","map","extension","id","join","host","version","commandLineParams","cefParams","cefParam","icons","icon","iconNormal","type","iconRollover","iconDarkNormal","iconDarkRollover","filter","size","panelWidth","panelHeight","minSize","panelMinWidth","panelMinHeight","maxSize","panelMaxWidth","panelMaxHeight","startOn","lifecycle","startOnEvents","length","e","htmlFilename","autoVisible","menu","title","href","Object","keys","debugPorts","trim","templateDebug","formatter","os","EOL","enablePlayerDebugMode","process","platform","execSync","i","disablePlayerDebugMode","camelToSnake","str","replace","part","toLowerCase","isTruthy","getEnvConfig","debugPortEnvs","env","key","indexOf","CEP_NAME","CEP_ID","CEP_VERSION","CEP_CEP_VERSION","CEP_HOSTS","CEP_ICON_NORMAL","CEP_ICON_ROLLOVER","CEP_ICON_DARK_NORMAL","CEP_ICON_DARK_ROLLOVER","CEP_PANEL_WIDTH","CEP_PANEL_HEIGHT","CEP_PANEL_MIN_WIDTH","CEP_PANEL_MIN_HEIGHT","CEP_PANEL_MAX_WIDTH","CEP_PANEL_MAX_HEIGHT","devHost","CEP_DEV_HOST","devPort","CEP_DEV_PORT","Number","reduce","obj","parseInt","debugInProduction","CEP_DEBUG_IN_PRODUCTION","CEP_CEF_PARAMS","split","getPkgConfig","pkg","pkgConfig","hasOwnProperty","cep","getConfigDefaults","PHXS","IDSN","AICY","ILST","PPRO","PRLD","AEFT","FLPR","AUDT","DRWV","MUST","KBRG","assignDefined","target","sources","source","val","getConfig","config","parseHosts","Array","isArray","push","objectToProcessEnv","forEach","envKey","toUpperCase","value","JSON","stringify","writeExtensionTemplates","opts","manifestContents","manifestTemplate","out","manifestDir","path","manifestFile","Promise","resolve","then","fs","ensureDir","writeFile","chain","debugContents","debugTemplate","panelContents","panelTemplate","hostsString","getExtenstionPath","homedir","APPDATA","getSymlinkExtensionPath","extensionPath","symlinkExtension","remove","symlink","copyDependencies","root","deps","dependencies","dep","src","dest","exists","statSync","isFile","err","copy","console","error","packageJson","readJsonSync","copyIcons","iconPaths","output","relative","all","compile","NODE_ENV","cwd","require","Error","allOpts","noSymlink"],"mappings":"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"}